@model GardenHub.Models.GardenCareActivity

@{
    ViewData["Title"] = "Edit Care Activity";
}

<div class="garden-dashboard-fixed-container">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="display-4 mb-0"><i class="bi bi-pencil"></i> Edit Garden Care Activity</h1>
        <div class="d-flex gap-2">
            <a asp-action="Details" asp-route-id="@Model.ActivityId" class="btn btn-info">
                <i class="bi bi-eye"></i> View Details
            </a>
            @if (Model.GardenId > 0)
            {
                <a asp-controller="Gardens" asp-action="Dashboard" asp-route-id="@Model.GardenId" class="btn btn-secondary">
                    <i class="bi bi-arrow-left"></i> Back to Dashboard
                </a>
            }
            else
            {
                <a asp-action="Index" class="btn btn-secondary">
                    <i class="bi bi-arrow-left"></i> Back to List
                </a>
            }
        </div>
    </div>

    <form asp-action="Edit" enctype="multipart/form-data">
        <div asp-validation-summary="ModelOnly" class="alert alert-danger" role="alert"></div>
        <input type="hidden" asp-for="ActivityId" />
        <input type="hidden" asp-for="UserId" />

        <!-- Basic Information Card -->
        <div class="card mb-4 shadow">
            <div class="card-header bg-success text-white">
                <h3 class="mb-0"><i class="bi bi-info-circle"></i> Basic Information</h3>
            </div>
            <div class="card-body">
                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="form-floating">
                            <select asp-for="GardenId" class="form-select" asp-items="ViewBag.GardenId" id="gardenId">
                                <option value="">-- Select Garden --</option>
                            </select>
                            <label asp-for="GardenId" for="gardenId">
                                <i class="bi bi-house-door"></i> Select Garden
                            </label>
                            <span asp-validation-for="GardenId" class="text-danger small"></span>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-floating">
                            <input asp-for="ActivityDate" type="datetime-local" class="form-control" id="activityDate" />
                            <label asp-for="ActivityDate" for="activityDate">
                                <i class="bi bi-calendar"></i> Activity Date & Time
                            </label>
                            <span asp-validation-for="ActivityDate" class="text-danger small"></span>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-floating">
                            <select asp-for="ActivityType" class="form-select" asp-items="Html.GetEnumSelectList<GardenHub.Models.Enums.CareActivityType>()" id="activityType">
                                <option value="">-- Select Activity Type --</option>
                            </select>
                            <label asp-for="ActivityType" for="activityType">
                                <i class="bi bi-list-check"></i> Activity Type
                            </label>
                            <span asp-validation-for="ActivityType" class="text-danger small"></span>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="form-floating">
                            <input asp-for="ActivityDuration" type="number" class="form-control" id="activityDuration" placeholder="Duration in minutes" />
                            <label asp-for="ActivityDuration" for="activityDuration">
                                <i class="bi bi-clock"></i> Activity Duration (minutes)
                            </label>
                            <span asp-validation-for="ActivityDuration" class="text-danger small"></span>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="form-floating">
                            <select asp-for="GardenStatus" class="form-select" asp-items="Html.GetEnumSelectList<GardenHub.Models.Enums.GardenStatus>()" id="gardenStatus">
                                <option value="">-- Select Status --</option>
                            </select>
                            <label asp-for="GardenStatus" for="gardenStatus">
                                <i class="bi bi-door-open"></i> Garden Status
                            </label>
                            <span asp-validation-for="GardenStatus" class="text-danger small"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Visual Inspection Card -->
        <div class="card mb-4 shadow">
            <div class="card-header bg-primary text-white">
                <h3 class="mb-0"><i class="bi bi-eye"></i> Visual Inspection</h3>
            </div>
            <div class="card-body">
                <div class="row g-4">
                    <div class="col-md-6">
                        <div class="form-floating">
                            <select asp-for="PlantInspectionStatus" class="form-select" asp-items="Html.GetEnumSelectList<GardenHub.Models.Enums.PlantInspectionStatus>()" id="plantInspection">
                                <option value="">-- Not Performed --</option>
                            </select>
                            <label asp-for="PlantInspectionStatus" for="plantInspection">
                                <i class="bi bi-flower3"></i> Plant Inspection Status
                            </label>
                            <span asp-validation-for="PlantInspectionStatus" class="text-danger small"></span>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="form-floating">
                            <select asp-for="EquipmentInspectionStatus" class="form-select" asp-items="Html.GetEnumSelectList<GardenHub.Models.Enums.EquipmentInspectionStatus>()" id="equipmentInspection">
                                <option value="">-- Not Performed --</option>
                            </select>
                            <label asp-for="EquipmentInspectionStatus" for="equipmentInspection">
                                <i class="bi bi-tools"></i> Equipment Inspection Status
                            </label>
                            <span asp-validation-for="EquipmentInspectionStatus" class="text-danger small"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Water Management Card -->
        <div class="card mb-4 shadow">
            <div class="card-header bg-info text-white">
                <h3 class="mb-0"><i class="bi bi-droplet-fill"></i> Water Management</h3>
            </div>
            <div class="card-body">
                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="form-floating">
                            <input asp-for="WaterLevel" type="number" step="0.1" class="form-control" id="waterLevel" placeholder="Current water level" />
                            <label asp-for="WaterLevel" for="waterLevel">
                                <i class="bi bi-speedometer2"></i> Current Water Level (Gallons)
                            </label>
                            <span asp-validation-for="WaterLevel" class="text-danger small"></span>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-check mt-3 ms-3">
                            <input asp-for="WateringPerformed" class="form-check-input" type="checkbox" id="wateringPerformed" />
                            <label asp-for="WateringPerformed" class="form-check-label" for="wateringPerformed">
                                <strong>Watering Performed</strong>
                            </label>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-floating">
                            <input asp-for="WaterAmountAdded" type="number" step="0.1" class="form-control" id="waterAmount" placeholder="Water amount added" />
                            <label asp-for="WaterAmountAdded" for="waterAmount">
                                <i class="bi bi-droplet"></i> Water Amount Added (Gallons)
                            </label>
                            <span asp-validation-for="WaterAmountAdded" class="text-danger small"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Nutrients Card -->
        <div class="card mb-4 shadow">
            <div class="card-header bg-warning text-dark">
                <h3 class="mb-0"><i class="bi bi-moisture"></i> Nutrients</h3>
            </div>
            <div class="card-body">
                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="form-check mt-3 ms-3">
                            <input asp-for="NutrientsAdded" class="form-check-input" type="checkbox" id="nutrientsAdded" />
                            <label asp-for="NutrientsAdded" class="form-check-label" for="nutrientsAdded">
                                <strong>Nutrients Added</strong>
                            </label>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-floating">
                            <input asp-for="NutrientType" class="form-control" id="nutrientType" placeholder="Nutrient type" />
                            <label asp-for="NutrientType" for="nutrientType">
                                <i class="bi bi-tag"></i> Nutrient Type/Brand
                            </label>
                            <span asp-validation-for="NutrientType" class="text-danger small"></span>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-floating">
                            <input asp-for="NutrientAmount" type="number" step="0.1" class="form-control" id="nutrientAmount" placeholder="Nutrient amount" />
                            <label asp-for="NutrientAmount" for="nutrientAmount">
                                <i class="bi bi-cup"></i> Amount (ml/oz)
                            </label>
                            <span asp-validation-for="NutrientAmount" class="text-danger small"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Planting & Maintenance Card -->
        <div class="card mb-4 shadow">
            <div class="card-header bg-success text-white">
                <h3 class="mb-0"><i class="bi bi-flower3"></i> Planting & Maintenance</h3>
            </div>
            <div class="card-body">
                <div class="row g-4">
                    <!-- New Plantings -->
                    <div class="col-12">
                        <h5 class="border-bottom pb-2 mb-3"><i class="bi bi-plus-circle"></i> New Plantings</h5>
                    </div>
                    <div class="col-md-4">
                        <div class="form-check mt-3 ms-3">
                            <input asp-for="NewPlantingsAdded" class="form-check-input" type="checkbox" id="newPlantings" />
                            <label asp-for="NewPlantingsAdded" class="form-check-label" for="newPlantings">
                                <strong>New Plantings Added</strong>
                            </label>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-floating">
                            <input asp-for="NumberOfPlantsAdded" type="number" class="form-control" id="plantCount" placeholder="Number of plants" />
                            <label asp-for="NumberOfPlantsAdded" for="plantCount">
                                <i class="bi bi-123"></i> Number of Plants
                            </label>
                            <span asp-validation-for="NumberOfPlantsAdded" class="text-danger small"></span>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-floating">
                            <input asp-for="PlantTypesAdded" class="form-control" id="plantTypes" placeholder="Plant types" />
                            <label asp-for="PlantTypesAdded" for="plantTypes">
                                <i class="bi bi-card-list"></i> Plant Names/Types
                            </label>
                            <span asp-validation-for="PlantTypesAdded" class="text-danger small"></span>
                        </div>
                    </div>

                    <!-- Weeding -->
                    <div class="col-12">
                        <h5 class="border-bottom pb-2 mb-3 mt-3"><i class="bi bi-trash"></i> Weeding</h5>
                    </div>
                    <div class="col-md-6">
                        <div class="form-check mt-3 ms-3">
                            <input asp-for="WeedingPerformed" class="form-check-input" type="checkbox" id="weeding" />
                            <label asp-for="WeedingPerformed" class="form-check-label" for="weeding">
                                <strong>Weeding Performed</strong>
                            </label>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="form-floating">
                            <input asp-for="WeedingDuration" type="number" class="form-control" id="weedingDuration" placeholder="Duration" />
                            <label asp-for="WeedingDuration" for="weedingDuration">
                                <i class="bi bi-clock"></i> Duration (minutes)
                            </label>
                            <span asp-validation-for="WeedingDuration" class="text-danger small"></span>
                        </div>
                    </div>

                    <!-- Pruning -->
                    <div class="col-12">
                        <h5 class="border-bottom pb-2 mb-3 mt-3"><i class="bi bi-scissors"></i> Pruning/Trimming</h5>
                    </div>
                    <div class="col-md-4">
                        <div class="form-check mt-3 ms-3">
                            <input asp-for="PruningPerformed" class="form-check-input" type="checkbox" id="pruning" />
                            <label asp-for="PruningPerformed" class="form-check-label" for="pruning">
                                <strong>Pruning Performed</strong>
                            </label>
                        </div>
                    </div>

                    <div class="col-md-8">
                        <div class="form-floating">
                            <input asp-for="PruningNotes" class="form-control" id="pruningNotes" placeholder="Pruning notes" />
                            <label asp-for="PruningNotes" for="pruningNotes">
                                <i class="bi bi-card-text"></i> Pruning Notes
                            </label>
                            <span asp-validation-for="PruningNotes" class="text-danger small"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pest Control Card -->
        <div class="card mb-4 shadow">
            <div class="card-header bg-danger text-white">
                <h3 class="mb-0"><i class="bi bi-bug"></i> Pest Control</h3>
            </div>
            <div class="card-body">
                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="form-check mt-3 ms-3">
                            <input asp-for="PestControlPerformed" class="form-check-input" type="checkbox" id="pestControl" />
                            <label asp-for="PestControlPerformed" class="form-check-label" for="pestControl">
                                <strong>Pest Control Performed</strong>
                            </label>
                        </div>
                    </div>

                    <div class="col-md-8">
                        <div class="form-floating">
                            <textarea asp-for="PestControlDetails" class="form-control" id="pestDetails" placeholder="Pest control details" style="height: 80px"></textarea>
                            <label asp-for="PestControlDetails" for="pestDetails">
                                <i class="bi bi-card-text"></i> Pest Control Details
                            </label>
                            <span asp-validation-for="PestControlDetails" class="text-danger small"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Water Quality Card -->
        <div class="card mb-4 shadow">
            <div class="card-header bg-info text-white">
                <h3 class="mb-0"><i class="bi bi-water"></i> Water Quality (Hydroponic/Aquaculture)</h3>
            </div>
            <div class="card-body">
                <div class="row g-4">
                    <div class="col-md-6">
                        <div class="form-floating">
                            <input asp-for="PhLevel" type="number" step="0.1" class="form-control" id="phLevel" placeholder="pH Level" />
                            <label asp-for="PhLevel" for="phLevel">
                                <i class="bi bi-droplet-half"></i> pH Level (0-14)
                            </label>
                            <span asp-validation-for="PhLevel" class="text-danger small"></span>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="form-floating">
                            <input asp-for="EcLevel" type="number" class="form-control" id="ecLevel" placeholder="EC/TDS Level" />
                            <label asp-for="EcLevel" for="ecLevel">
                                <i class="bi bi-speedometer"></i> EC/TDS Level (ppm)
                            </label>
                            <span asp-validation-for="EcLevel" class="text-danger small"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes & Image Card -->
        <div class="card mb-4 shadow">
            <div class="card-header bg-secondary text-white">
                <h3 class="mb-0"><i class="bi bi-sticky"></i> Notes & Documentation</h3>
            </div>
            <div class="card-body">
                <div class="row g-4">
                    <div class="col-12">
                        <div class="form-floating">
                            <textarea asp-for="Notes" class="form-control" id="notes" placeholder="Additional notes" style="height: 120px"></textarea>
                            <label asp-for="Notes" for="notes">
                                <i class="bi bi-card-text"></i> Additional Notes
                            </label>
                            <span asp-validation-for="Notes" class="text-danger small"></span>
                        </div>
                    </div>

                    <div class="col-12">
                        <label class="form-label"><i class="bi bi-camera"></i> Upload New Image (Optional)</label>
                        <input asp-for="ImageFile" type="file" class="form-control" id="imageFile" accept="image/*" />
                        <span asp-validation-for="ImageFile" class="text-danger small"></span>
                        <div class="form-text">Leave empty to keep existing image, or upload a new one to replace it (max 5MB)</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="card shadow">
            <div class="card-body">
                <div class="d-flex gap-2 justify-content-center flex-wrap">
                    <button type="submit" class="btn btn-success btn-lg">
                        <i class="bi bi-check-circle"></i> Save Changes
                    </button>
                    <a asp-action="Details" asp-route-id="@Model.ActivityId" class="btn btn-info btn-lg">
                        <i class="bi bi-eye"></i> View Details
                    </a>
                    @if (Model.GardenId > 0)
                    {
                        <a asp-controller="Gardens" asp-action="Dashboard" asp-route-id="@Model.GardenId" class="btn btn-secondary btn-lg">
                            <i class="bi bi-x-circle"></i> Cancel
                        </a>
                    }
                    else
                    {
                        <a asp-action="Index" class="btn btn-secondary btn-lg">
                            <i class="bi bi-x-circle"></i> Cancel
                        </a>
                    }
                </div>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
